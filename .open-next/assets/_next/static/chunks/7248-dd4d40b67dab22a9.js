"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7248],{7604:(e,t,r)=>{r.d(t,{default:()=>c});var n=r(95155),s=r(12115),a=r(15239),o=r(20063),l=r(64269);function c(e){let{onClose:t,initialQuery:r=""}=e,[c,i]=(0,s.useState)(r),[u,d]=(0,s.useState)([]),[h,m]=(0,s.useState)(!1),[x,f]=(0,s.useState)(-1),[g,p]=(0,s.useState)(!1),b=(0,o.useRouter)(),y=(0,s.useRef)(null),j=(0,s.useRef)(null),N=(0,s.useRef)(null);(0,s.useEffect)(()=>{y.current&&y.current.focus()},[]),(0,s.useEffect)(()=>{r&&r!==c&&i(r)},[r]),(0,s.useEffect)(()=>{if(c.length<2){d([]),p(!1);return}return N.current&&clearTimeout(N.current),m(!0),p(!0),N.current=setTimeout(async()=>{try{let e=await fetch("/api/search/autocomplete?q=".concat(encodeURIComponent(c)));if(e.ok){let t=await e.json();d(t.results||[])}else d([])}catch(e){d([])}finally{m(!1)}},300),()=>{N.current&&clearTimeout(N.current)}},[c]);let v=e=>{let r=(0,l.z)("".concat(e.brand," ").concat(e.name),e.id);b.push("/products/".concat(r)),i(""),d([]),p(!1),null==t||t()},w=e=>{e.preventDefault(),c.trim().length>=2&&(b.push("/search?q=".concat(encodeURIComponent(c.trim()))),i(""),d([]),p(!1),null==t||t())};return(0,s.useEffect)(()=>{if(x>=0&&j.current){let e=j.current.children[x];e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}},[x]),(0,n.jsxs)("div",{className:"relative w-full",children:[(0,n.jsxs)("form",{onSubmit:w,className:"relative",children:[(0,n.jsx)("input",{ref:y,type:"text",value:c,onChange:e=>{i(e.target.value),f(-1)},onKeyDown:e=>{if(!g||0===u.length){"Enter"===e.key&&c.trim().length>=2&&w(e);return}switch(e.key){case"ArrowDown":e.preventDefault(),f(e=>e<u.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),f(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),x>=0&&x<u.length?v(u[x]):c.trim().length>=2&&w(e);break;case"Escape":p(!1),d([]),null==t||t()}},onFocus:()=>{(u.length>0||c.length>=2)&&p(!0)},placeholder:"Бүтээгдэхүүн хайх...",className:"w-full rounded-full border border-gray-300 px-4 py-2 pl-10 pr-10 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900"}),(0,n.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.length>0&&(0,n.jsx)("button",{type:"button",onClick:()=>{i(""),d([]),p(!1),y.current&&y.current.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:(0,n.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g&&(c.length>=2||u.length>0)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>{p(!1)}}),(0,n.jsx)("div",{ref:j,className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-xl z-20 max-h-96 overflow-y-auto",children:h?(0,n.jsx)("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsxs)("svg",{className:"animate-spin h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Хайж байна..."]})}):u.length>0?(0,n.jsx)(n.Fragment,{children:u.map((e,t)=>(0,n.jsxs)("button",{onClick:()=>v(e),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors text-left border-b border-gray-100 last:border-b-0 ".concat(t===x?"bg-gray-50":""," ").concat(0===t?"rounded-t-lg":""," ").concat(t===u.length-1?"rounded-b-lg":""),children:[e.image?(0,n.jsx)("div",{className:"w-12 h-12 rounded border border-gray-200 flex-shrink-0 overflow-hidden relative",children:(0,n.jsx)(a.default,{src:e.image,alt:e.name,fill:!0,sizes:"48px",className:"object-cover",loading:"lazy"})}):(0,n.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded border border-gray-200 flex-shrink-0"}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),e.nameMn&&(0,n.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.nameMn}),(0,n.jsxs)("p",{className:"text-xs text-gray-600 mt-0.5",children:[e.brand&&"".concat(e.brand," • "),new Intl.NumberFormat("mn-MN").format(e.price)," ₮"]})]})]},e.id))}):c.length>=2?(0,n.jsxs)("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:[(0,n.jsx)("p",{children:"Илэрц олдсонгүй"}),(0,n.jsxs)("p",{className:"text-xs mt-1 text-gray-400",children:['"',c,'" гэсэн хайлтаар бүтээгдэхүүн олдсонгүй']})]}):null})]})]})}},32025:(e,t,r)=>{r.d(t,{default:()=>o});var n=r(95155),s=r(12115),a=r(7604);function o(){let[e,t]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let r=r=>{"Escape"===r.key&&e&&t(!1)};return e?(document.addEventListener("keydown",r),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.removeEventListener("keydown",r),document.body.style.overflow=""}},[e]),e)?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-start justify-center pt-20 px-4",onClick:()=>t(!1),children:(0,n.jsxs)("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl p-4",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Хайлт"}),(0,n.jsx)("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close search",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,n.jsx)(a.default,{onClose:()=>t(!1)})]})})}):(0,n.jsx)("button",{onClick:()=>t(!0),className:"inline-flex items-center justify-center w-9 h-9 rounded-full border border-gray-200 text-gray-600 hover:text-gray-900 hover:border-gray-300 transition-colors","aria-label":"Хайлт нээх",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})}},64269:(e,t,r)=>{function n(e,t){let r=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");if(t){let e=t.replace(/[^a-z0-9]+/gi,"-").toLowerCase();return"".concat(r,"-").concat(e)}return r}function s(e){return new Intl.NumberFormat("mn-MN").format(e)}r.d(t,{$:()=>s,z:()=>n})},96648:(e,t,r)=>{r.d(t,{U:()=>l});var n=r(55417);let s="https://ejdwrepyuznanwujidai.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVqZHdyZXB5dXpuYW53dWppZGFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzNjk3NTYsImV4cCI6MjA4Mzk0NTc1Nn0.MRJe6csColzMRDpAWa-Ma99noAk6n8SbnXXHP2rNAJ4",o=null;function l(){return function(){if(!s||s.includes("placeholder")||s.includes("MISSING"))throw Error("❌ Supabase configuration missing!\n\nNEXT_PUBLIC_SUPABASE_URL is not set.\n\nTo fix this:\n1. Go to Cloudflare Dashboard → Workers & Pages → Your Project\n2. Settings → Environment variables\n3. Add NEXT_PUBLIC_SUPABASE_URL with your Supabase project URL\n\nSee DEPLOYMENT.md for detailed instructions.");if(!a||a.includes("placeholder")||a.includes("MISSING"))throw Error("❌ Supabase configuration missing!\n\nNEXT_PUBLIC_SUPABASE_ANON_KEY is not set.\n\nTo fix this:\n1. Go to Cloudflare Dashboard → Workers & Pages → Your Project\n2. Settings → Environment variables\n3. Add NEXT_PUBLIC_SUPABASE_ANON_KEY with your Supabase anon key\n\nSee DEPLOYMENT.md for detailed instructions.")}(),o||(o=(0,n.createBrowserClient)(s,a)),o}}}]);