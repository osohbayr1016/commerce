(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,21440,e=>{"use strict";var t=e.i(43476),s=e.i(71645);function r(){let[e,r]=(0,s.useState)([]),[a,l]=(0,s.useState)([]),[i,d]=(0,s.useState)(null),[n,c]=(0,s.useState)(!0),[o,x]=(0,s.useState)(!1),[m,g]=(0,s.useState)(""),[h,u]=(0,s.useState)(""),[p,b]=(0,s.useState)(!1),[j,v]=(0,s.useState)(""),[y,f]=(0,s.useState)(""),[N,w]=(0,s.useState)(""),[S,_]=(0,s.useState)("");(0,s.useEffect)(()=>{C(),k(),L()},[]);let C=async()=>{try{let e=await fetch("/api/admin/spin/products");if(e.ok){let t=await e.json();r(t)}}catch(e){console.error("Error fetching spin products:",e)}finally{c(!1)}},k=async()=>{try{let e=await fetch("/api/admin/products");if(e.ok){let t=await e.json();l(t.products||[])}}catch(e){console.error("Error fetching products:",e)}},L=async()=>{try{let e=await fetch("/api/admin/spin/statistics?days=30");if(e.ok){let t=await e.json();d(t)}}catch(e){console.error("Error fetching statistics:",e)}},T=async()=>{if(!j)return void g("Ð‘Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ ÑÐ¾Ð½Ð³Ð¾Ð½Ð¾ ÑƒÑƒ");x(!0),g(""),u("");try{let t=await fetch("/api/admin/spin/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:j,display_name:y||null,image_url:N||null,is_active:!0})}),s=await t.json();t.ok?(u("ÐÐ¼Ð¶Ð¸Ð»Ñ‚Ñ‚Ð°Ð¹ Ð½ÑÐ¼ÑÐ³Ð´Ð»ÑÑ!"),r([s,...e]),b(!1),v(""),f(""),w(""),L()):g(s.error||"ÐÐ»Ð´Ð°Ð° Ð³Ð°Ñ€Ð»Ð°Ð°")}catch(e){g("Ð¡ÐµÑ€Ð²ÐµÑ€Ð¸Ð¹Ð½ Ð°Ð»Ð´Ð°Ð° Ð³Ð°Ñ€Ð»Ð°Ð°")}finally{x(!1)}},E=async(t,s)=>{x(!0);try{let a=await fetch("/api/admin/spin/products",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,is_active:!s})});if(a.ok){let s=await a.json();r(e.map(e=>e.id===t?s:e)),u("Ð¡Ñ‚Ð°Ñ‚ÑƒÑ ÑˆÐ¸Ð½ÑÑ‡Ð»ÑÐ³Ð´Ð»ÑÑ"),L()}}catch(e){g("ÐÐ»Ð´Ð°Ð° Ð³Ð°Ñ€Ð»Ð°Ð°")}finally{x(!1)}},O=async t=>{if(confirm("Ð­Ð½Ñ Ð±Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½Ð¸Ð¹Ð³ spin-Ð°Ð°Ñ Ñ…Ð°ÑÐ°Ñ… ÑƒÑƒ?")){x(!0);try{(await fetch(`/api/admin/spin/products?id=${t}`,{method:"DELETE"})).ok&&(r(e.filter(e=>e.id!==t)),u("ÐÐ¼Ð¶Ð¸Ð»Ñ‚Ñ‚Ð°Ð¹ ÑƒÑÑ‚Ð³Ð°Ð³Ð´Ð»Ð°Ð°"),L())}catch(e){g("ÐÐ»Ð´Ð°Ð° Ð³Ð°Ñ€Ð»Ð°Ð°")}finally{x(!1)}}},P=a.filter(t=>!e.some(e=>e.product_id===t.id)).filter(e=>!S||e.name_mn?.toLowerCase().includes(S.toLowerCase())||e.name_en?.toLowerCase().includes(S.toLowerCase())||e.brand?.toLowerCase().includes(S.toLowerCase())),A=e.filter(e=>e.is_active).length;return n?(0,t.jsx)("div",{className:"p-8 text-center",children:"ÐÑ‡Ð°Ð°Ð»Ð»Ð°Ð¶ Ð±Ð°Ð¹Ð½Ð°..."}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"ðŸŽ° Spin Wheel Ð‘Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Spin Ð´ÑÑÑ€ Ñ…Ð°Ñ€Ð°Ð³Ð´Ð°Ñ… Ð±Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½Ò¯Ò¯Ð´Ð¸Ð¹Ð³ ÑƒÐ´Ð¸Ñ€Ð´Ð°Ñ…"})]}),(0,t.jsx)("button",{onClick:()=>{b(!0),k()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"+ Ð‘Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ Ð½ÑÐ¼ÑÑ…"})]}),m&&(0,t.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:m}),h&&(0,t.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg text-green-700",children:h}),i&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:" from-blue-50 to-blue-100 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:"ÐÐ¸Ð¹Ñ‚ Spin"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-900 mt-1",children:i.total_spins}),(0,t.jsx)("div",{className:"text-xs text-blue-700 mt-1",children:"Ð¡Ò¯Ò¯Ð»Ð¸Ð¹Ð½ 30 Ñ…Ð¾Ð½Ð¾Ð³"})]}),(0,t.jsxs)("div",{className:" from-green-50 to-green-100 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-green-600 font-medium",children:"ÐžÑ€Ð»Ð¾Ð³Ð¾"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-green-900 mt-1",children:["â‚®",(i.total_revenue_mnt||0).toLocaleString()]}),(0,t.jsxs)("div",{className:"text-xs text-green-700 mt-1",children:[i.unique_users," Ñ…ÑÑ€ÑÐ³Ð»ÑÐ³Ñ‡"]})]}),(0,t.jsxs)("div",{className:" from-purple-50 to-purple-100 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-purple-600 font-medium",children:"Ð”ÑƒÐ½Ð´Ð°Ð¶ Spin"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-900 mt-1",children:i.avg_spins_per_user.toFixed(1)}),(0,t.jsx)("div",{className:"text-xs text-purple-700 mt-1",children:"Ñ…ÑÑ€ÑÐ³Ð»ÑÐ³Ñ‡ Ñ‚ÑƒÑ‚Ð°Ð¼Ð´"})]}),(0,t.jsxs)("div",{className:" from-orange-50 to-orange-100 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-orange-600 font-medium",children:"Ð˜Ð´ÑÐ²Ñ…Ñ‚ÑÐ¹"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-orange-900 mt-1",children:A}),(0,t.jsxs)("div",{className:"text-xs text-orange-700 mt-1",children:["/",e.length," Ð±Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½"]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,t.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Spin Ð‘Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ (",e.length,")"]})}),(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:0===e.length?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Spin Ð±Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ Ð±Ð°Ð¹Ñ…Ð³Ò¯Ð¹ Ð±Ð°Ð¹Ð½Ð°"}):e.map(e=>(0,t.jsx)("div",{className:"p-4 hover:bg-gray-50",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("img",{src:e.image_url||e.product?.image_url||"/placeholder.png",alt:"",className:"w-16 h-16 object-cover rounded-lg"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.display_name||e.product?.name_mn||"No name"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[e.product?.brand," â€¢ â‚®",(e.product?.price||0).toLocaleString()]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["ÐÑÐ¼ÑÑÐ½:"," ",new Date(e.created_at).toLocaleDateString("mn-MN")]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>E(e.id,e.is_active),disabled:o,className:`px-3 py-1 rounded-lg text-sm font-medium ${e.is_active?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:e.is_active?"âœ“ Ð˜Ð´ÑÐ²Ñ…Ñ‚ÑÐ¹":"âœ— Ð˜Ð´ÑÐ²Ñ…Ð³Ò¯Ð¹"}),(0,t.jsx)("button",{onClick:()=>O(e.id),disabled:o,className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg text-sm font-medium hover:bg-red-200",children:"Ð£ÑÑ‚Ð³Ð°Ñ…"})]})]})},e.id))})]}),p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-500/40 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Spin-Ð´ Ð±Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ Ð½ÑÐ¼ÑÑ…"})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ð‘Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ Ñ…Ð°Ð¹Ñ…"}),(0,t.jsx)("input",{type:"text",value:S,onChange:e=>_(e.target.value),placeholder:"ÐÑÑ€, Ð±Ñ€ÑÐ½Ð´...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ð‘Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ ÑÐ¾Ð½Ð³Ð¾Ñ… *"}),(0,t.jsx)("div",{className:"border border-gray-300 rounded-lg max-h-64 overflow-y-auto",children:0===P.length?(0,t.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Ð‘Ð¾Ð»Ð¾Ð¼Ð¶Ñ‚Ð¾Ð¹ Ð±Ò¯Ñ‚ÑÑÐ³Ð´ÑÑ…Ò¯Ò¯Ð½ Ð±Ð°Ð¹Ñ…Ð³Ò¯Ð¹"}):P.map(e=>(0,t.jsx)("div",{onClick:()=>v(e.id),className:`p-3 border-b border-gray-200 cursor-pointer hover:bg-gray-50 ${j===e.id?"bg-blue-50":""}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("img",{src:e.image_url||"/placeholder.png",alt:"",className:"w-12 h-12 object-cover rounded"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.name_mn}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[e.brand," â€¢ â‚®",(e.price||0).toLocaleString()]})]}),j===e.id&&(0,t.jsx)("span",{className:"text-blue-600",children:"âœ“"})]})},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spin Ð´ÑÑÑ€Ñ… Ð½ÑÑ€ (Ð·Ð°Ð°Ð²Ð°Ð» Ð±Ð¸Ñˆ)"}),(0,t.jsx)("input",{type:"text",value:y,onChange:e=>f(e.target.value),placeholder:"ÐÐ½Ñ…Ð½Ñ‹ Ð½ÑÑ€Ð¸Ð¹Ð³ Ð°ÑˆÐ¸Ð³Ð»Ð°Ð½Ð°",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spin Ð´ÑÑÑ€Ñ… Ð·ÑƒÑ€Ð°Ð³ URL (Ð·Ð°Ð°Ð²Ð°Ð» Ð±Ð¸Ñˆ)"}),(0,t.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value),placeholder:"ÐÐ½Ñ…Ð½Ñ‹ Ð·ÑƒÑ€Ð³Ð¸Ð¹Ð³ Ð°ÑˆÐ¸Ð³Ð»Ð°Ð½Ð°",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]})]}),(0,t.jsxs)("div",{className:"p-6 border-t border-gray-200 flex gap-3 justify-end",children:[(0,t.jsx)("button",{onClick:()=>{b(!1),v(""),f(""),w("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Ð‘Ð¾Ð»Ð¸Ñ…"}),(0,t.jsx)("button",{onClick:T,disabled:o||!j,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:o?"ÐÑÐ¼Ð¶ Ð±Ð°Ð¹Ð½Ð°...":"ÐÑÐ¼ÑÑ…"})]})]})})]})}e.s(["default",()=>r])}]);