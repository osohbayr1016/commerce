(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,35016,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(43066);function s({images:e,onImagesChange:s}){let[l,o]=(0,a.useState)(!1),[i,n]=(0,a.useState)(0),[d,c]=(0,a.useState)(!1),m=(0,a.useRef)(null),u=(0,t.useModal)(),h=(0,a.useCallback)(async r=>{if(r&&0!==r.length){o(!0),n(0);try{let a=new FormData;Array.from(r).forEach(e=>{a.append("files",e)});let t=await fetch("/api/images/upload",{method:"POST",body:a});if(!t.ok){let e=await t.json(),r=e.details?`${e.error}: ${Array.isArray(e.details)?e.details.join(", "):e.details}`:e.error||"Upload failed";throw Error(r)}let l=(await t.json()).images.map(e=>e.url);s([...e,...l]),n(100)}catch(e){u.showError("Upload алдаа",e instanceof Error?e.message:"Upload failed")}finally{o(!1),n(0),m.current&&(m.current.value="")}}},[e,s]),g=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?c(!0):"dragleave"===e.type&&c(!1)},[]),p=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),c(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&h(e.dataTransfer.files)},[h]);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Зураг *"}),(0,r.jsxs)("div",{onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:p,className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${d?"border-gray-900 bg-gray-50":"border-gray-300 bg-white hover:border-gray-400"} ${l?"opacity-50 pointer-events-none":""}`,children:[(0,r.jsx)("input",{ref:m,type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:e=>{e.target.files&&e.target.files.length>0&&h(e.target.files)},className:"hidden",disabled:l}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Зураг чирж тавих эсвэл"," ",(0,r.jsx)("button",{type:"button",onClick:()=>m.current?.click(),className:"text-gray-900 font-medium underline hover:text-gray-700",children:"файл сонгох"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"JPG, PNG, WEBP (Хамгийн ихдээ 10MB)"})]}),l&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-gray-900 h-2 rounded-full transition-all",style:{width:`${i}%`}})})})]}),e.length>0&&(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:e.map((a,t)=>(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("img",{src:a,alt:`Product ${t+1}`,className:"w-full aspect-square object-cover rounded-lg border border-gray-200"}),(0,r.jsx)("button",{type:"button",onClick:()=>{s(e.filter((e,r)=>r!==t))},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Remove image",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t))})]})}e.s(["default",()=>s])},71911,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(35016);function s({isOpen:e,title:a,message:t,confirmText:s="Remove",cancelText:l="Cancel",isDeleting:o=!1,onConfirm:i,onCancel:n}){return e?(0,r.jsx)("div",{className:"fixed inset-0 z-[100] overflow-y-auto",role:"dialog","aria-modal":"true","aria-labelledby":"hero-delete-title",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center px-4",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600/75","aria-hidden":"true",onClick:o?void 0:n}),(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-red-100",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,r.jsx)("h2",{id:"hero-delete-title",className:"text-lg font-semibold text-gray-900",children:a})]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-6",children:t}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:n,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:l}),(0,r.jsx)("button",{type:"button",onClick:i,disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50",children:o?"Removing…":s})]})]})]})}):null}function l({banners:e,onDelete:a}){return 0===e.length?null:(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current carousel slides"}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:e.map(e=>(0,r.jsxs)("div",{className:"group relative aspect-video rounded-lg overflow-hidden border border-gray-200 bg-gray-100",children:[(0,r.jsx)("img",{src:e.image_url||"",alt:"Slide",className:"w-full h-full object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>a(e.id),className:"absolute top-2 right-2 rounded-full bg-red-500 p-1.5 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600","aria-label":"Remove from carousel",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e.id))})]})}var o=e.i(43066),i=e.i(88442);function n(){let[e,n]=(0,a.useState)([]),[d,c]=(0,a.useState)(!0),[m,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[p,x]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),y=(0,o.useModal)();(0,a.useEffect)(()=>{v()},[]);let v=async()=>{try{g(!1);let e=await fetch("/api/admin/hero");if(!e.ok){let r=(await e.json().catch(()=>({}))).error||`Request failed with status ${e.status}`;if(r.includes("hero_banners")&&(r.includes("does not exist")||r.includes("Could not find the table"))){g(!0),c(!1);return}throw Error(r)}let r=await e.json().catch(()=>null);n(Array.isArray(r)?r.filter(e=>null!=e&&"object"==typeof e&&"string"==typeof e.id&&"string"==typeof e.image_url).map(e=>({id:String(e.id),image_url:String(e.image_url||""),title:null!=e.title?String(e.title):null,link:null!=e.link?String(e.link):null,sort_order:Number(e.sort_order)||0,is_active:!1!==e.is_active})):[])}catch(e){y.showError("Error","Failed to load banners: "+(e instanceof Error?e.message:"Unknown error"))}finally{c(!1)}},j=async e=>{if(0!==e.length){if(h)return void y.showError("Setup required","Run the database setup first, then upload again.");u(!0);try{for(let r of e){let e=await fetch("/api/admin/hero",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_url:r})});if(!e.ok){let r=await e.json().catch(()=>({}));throw Error(r.error||"Failed to save")}}await v(),y.showSuccess("Saved","Image(s) added to home page hero carousel.")}catch(e){y.showError("Error",e instanceof Error?e.message:"Failed to save. Run setup first if needed.")}finally{u(!1)}}},w=async()=>{if(p){b(!0);try{let e=await fetch(`/api/admin/hero?id=${encodeURIComponent(p)}`,{method:"DELETE"});if(!e.ok){let r=await e.json().catch(()=>({}));throw Error(r.error||"Failed")}n(e=>e.filter(e=>String(e.id)!==String(p))),y.showSuccess("Removed","Image removed from carousel."),x(null)}catch(e){y.showError("Error",e instanceof Error?e.message:"Failed to remove.")}finally{b(!1)}}};return d?(0,r.jsxs)("div",{className:"space-y-6 pb-20",children:[(0,r.jsx)(i.default,{className:"h-8 w-48"}),(0,r.jsx)(i.default,{className:"h-40 w-full max-w-xl rounded-xl"})]}):(0,r.jsxs)("div",{className:"space-y-6 pb-20",children:[(0,r.jsx)(s,{isOpen:null!==p,title:"Remove from carousel",message:"Remove this image from the hero carousel?",confirmText:"Remove",cancelText:"Cancel",isDeleting:f,onConfirm:w,onCancel:()=>{f||x(null)}}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Hero carousel images"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Upload images here. They appear in the hero carousel on the home page."}),h&&(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3 rounded-xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:[(0,r.jsx)("span",{children:"Database setup required."}),(0,r.jsx)("a",{href:"/admin/setup-hero",className:"font-medium text-amber-900 underline hover:no-underline",children:"Open setup & copy SQL"}),(0,r.jsx)("button",{type:"button",onClick:()=>{c(!0),v()},className:"rounded-lg border border-amber-300 bg-white px-3 py-1.5 font-medium hover:bg-amber-100",children:"I ran the SQL — Retry"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload hero images"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Add one or more images. Each image becomes a slide in the home page hero carousel."}),m&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Saving…"}),(0,r.jsx)("div",{className:m?"pointer-events-none opacity-70":"",children:(0,r.jsx)(t.default,{images:[],onImagesChange:j})})]}),(0,r.jsx)(l,{banners:e,onDelete:e=>x(e)}),!h&&0===e.length&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No images yet. Upload above to add slides to the home page hero carousel."})]})}e.s(["default",()=>n],71911)}]);