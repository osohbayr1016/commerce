(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4016],{29960:(e,t,s)=>{Promise.resolve().then(s.bind(s,63493))},63493:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var r=s(95155),a=s(12115);function l(){let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)(!0),[d,n]=(0,a.useState)(""),[i,o]=(0,a.useState)([]),[c,x]=(0,a.useState)(!1),[m,h]=(0,a.useState)(""),[p,g]=(0,a.useState)("");(0,a.useEffect)(()=>{u()},[]);let u=async()=>{try{let e=await fetch("/api/admin/top6");if(e.ok){let s=await e.json();t(s.top6||[])}}catch(e){console.error("Failed to fetch Top 6:",e)}finally{l(!1)}},b=async()=>{if(d.trim()){x(!0),o([]);try{let e=await fetch("/api/admin/users/search?q=".concat(encodeURIComponent(d)));if(e.ok){let t=await e.json();o(t.users||[])}}catch(e){console.error("Search failed:",e)}finally{x(!1)}}},y=async e=>{h(""),g("");try{let t=await fetch("/api/admin/top6",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})}),s=await t.json();t.ok?(g(s.message),await u(),n(""),o([])):h(s.error)}catch(e){h("Алдаа гарлаа")}},j=async e=>{if(confirm("Top 6-с хасах уу?")){h(""),g("");try{let t=await fetch("/api/admin/top6?userId=".concat(e),{method:"DELETE"}),s=await t.json();t.ok?(g(s.message),await u()):h(s.error)}catch(e){h("Алдаа гарлаа")}}};return s?(0,r.jsx)("div",{className:"text-center py-8",children:"Уншиж байна..."}):(0,r.jsxs)("div",{className:"space-y-6",children:[m&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:m}),p&&(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:p}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["Top 6 Members (",e.length,"/6)"]}),0===e.length?(0,r.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Top 6 гишүүд байхгүй байна"}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(e=>{var t,s;return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 from-yellow-50 to-amber-50",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:e.full_name||"Хэрэглэгч"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),e.promo_code&&(0,r.jsx)("p",{className:"text-xs font-mono text-gray-500 mt-1",children:e.promo_code})]}),(0,r.jsx)("button",{onClick:()=>j(e.id),className:"text-red-600 hover:text-red-700 text-sm",children:"Хасах"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,r.jsxs)("div",{className:"bg-white rounded p-2",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Referrals"}),(0,r.jsx)("p",{className:"text-lg font-bold text-gray-900",children:(null==(t=e.stats)?void 0:t.total_referrals)||0})]}),(0,r.jsxs)("div",{className:"bg-white rounded p-2",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Discount"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-yellow-600",children:[e.accumulated_discount_percent,"%"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded p-2",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Network"}),(0,r.jsx)("p",{className:"text-lg font-bold text-gray-900",children:(null==(s=e.stats)?void 0:s.network_size)||0})]})]})]},e.id)})})]}),e.length<6&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top 6-д хүн нэмэх"}),(0,r.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,r.jsx)("input",{type:"text",value:d,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&b(),placeholder:"Promo код, и-мэйл, нэр хайх...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("button",{onClick:b,disabled:c,className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition disabled:opacity-50",children:c?"Хайж байна...":"Хайх"})]}),i.length>0&&(0,r.jsx)("div",{className:"space-y-2",children:i.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.full_name||"Хэрэглэгч"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),e.promo_code&&(0,r.jsx)("p",{className:"text-xs font-mono text-gray-500",children:e.promo_code})]}),(0,r.jsx)("button",{onClick:()=>y(e.id),className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm transition",children:"Top 6-д нэмэх"})]},e.id))})]})]})}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=29960)),_N_E=e.O()}]);