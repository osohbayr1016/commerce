(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1175],{9739:(e,s,t)=>{Promise.resolve().then(t.bind(t,84350))},84350:(e,s,t)=>{"use strict";t.d(s,{default:()=>n});var l=t(95155),r=t(12115);function a(e){let{node:s,onNodeClick:t}=e,[n,o]=(0,r.useState)(s.level<2),c=s.children&&s.children.length>0,i=24*s.level;return(0,l.jsxs)("div",{style:{marginLeft:"".concat(i,"px")},className:"mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg border transition-colors cursor-pointer ".concat(s.is_top6?"border-yellow-300 bg-yellow-50 hover:bg-yellow-100":"border-gray-200 bg-white hover:bg-gray-50"),onClick:()=>t(s),children:[c&&(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),o(!n)},className:"text-gray-500 hover:text-gray-700",children:n?"▼":"▶"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"font-semibold text-gray-900",children:s.name}),s.is_top6&&(0,l.jsx)("span",{className:"px-2 py-0.5 bg-yellow-500 text-white text-xs rounded-full",children:"Top 6"})]}),s.promo_code&&(0,l.jsx)("p",{className:"text-xs font-mono text-gray-500 mt-1",children:s.promo_code}),(0,l.jsxs)("div",{className:"flex gap-4 mt-2 text-xs",children:[(0,l.jsxs)("span",{className:"text-gray-600",children:["Referrals: ",(0,l.jsx)("span",{className:"font-semibold",children:s.referral_count})]}),(0,l.jsxs)("span",{className:"text-yellow-600",children:["Discount: ",(0,l.jsxs)("span",{className:"font-semibold",children:[s.discount_percent,"%"]})]}),(0,l.jsxs)("span",{className:"text-gray-400",children:["Level: ",s.level]})]})]})]}),n&&c&&(0,l.jsx)("div",{className:"mt-2",children:s.children.map(e=>(0,l.jsx)(a,{node:e,onNodeClick:t},e.id))})]})}function n(){var e;let[s,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[c,i]=(0,r.useState)(null),[d,x]=(0,r.useState)("top6"),[m,h]=(0,r.useState)("");(0,r.useEffect)(()=>{p()},[d]);let p=async()=>{o(!0);try{let e=await fetch("top6"===d?"/api/admin/referral-network?top6Only=true":m?"/api/admin/referral-network?userId=".concat(m):"/api/admin/referral-network");if(e.ok){let s=await e.json();t("top6"===d?s.top6_networks||[]:[s.network])}}catch(e){console.error("Failed to fetch networks:",e)}finally{o(!1)}},g=e=>{i(e)};return n?(0,l.jsx)("div",{className:"text-center py-8",children:"Уншиж байна..."}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Referral Network Viewer"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>x("top6"),className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat("top6"===d?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Top 6 Networks"}),(0,l.jsx)("button",{onClick:()=>x("user"),className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat("user"===d?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Specific User"})]})]}),"user"===d&&(0,l.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,l.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"User ID оруулна уу...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,l.jsx)("button",{onClick:p,className:"px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition",children:"Хайх"})]}),(0,l.jsx)("div",{className:"text-xs text-gray-500 mb-4",children:"\uD83D\uDCA1 Node дээр дарж дэлгэрэнгүй харах. ▶/▼ дарж задлах/хураах"})]}),0===s.length?(0,l.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-8 text-center text-gray-500",children:"Мэдээлэл олдсонгүй"}):(0,l.jsx)("div",{className:"space-y-4",children:"top6"===d?s.map(e=>(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.top6Member.full_name||"Хэрэглэгч"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:[e.top6Member.promo_code," • ",e.top6Member.total_referrals," referrals"]})]}),e.network?(0,l.jsx)(a,{node:e.network,onNodeClick:g}):(0,l.jsx)("p",{className:"text-gray-500 text-sm",children:"Referral байхгүй"})]},e.top6Member.id)):(0,l.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:s[0]?(0,l.jsx)(a,{node:s[0],onNodeClick:g}):(0,l.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Мэдээлэл байхгүй"})})}),c&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Node Details"}),(0,l.jsx)("button",{onClick:()=>i(null),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Нэр"}),(0,l.jsx)("p",{className:"font-semibold text-gray-900",children:c.name})]}),c.promo_code&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Promo Code"}),(0,l.jsx)("p",{className:"font-mono font-semibold text-gray-900",children:c.promo_code})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Referrals"}),(0,l.jsx)("p",{className:"text-lg font-bold text-gray-900",children:c.referral_count})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Discount"}),(0,l.jsxs)("p",{className:"text-lg font-bold text-yellow-600",children:[c.discount_percent,"%"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Level"}),(0,l.jsx)("p",{className:"text-lg font-bold text-gray-900",children:c.level})]})]}),c.is_top6&&(0,l.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,l.jsx)("p",{className:"text-sm font-semibold text-yellow-800",children:"⭐ Top 6 Member"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Children"}),(0,l.jsxs)("p",{className:"font-semibold text-gray-900",children:[(null==(e=c.children)?void 0:e.length)||0," direct referrals"]})]})]}),(0,l.jsx)("button",{onClick:()=>i(null),className:"w-full mt-6 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition",children:"Хаах"})]})})]})}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=9739)),_N_E=e.O()}]);