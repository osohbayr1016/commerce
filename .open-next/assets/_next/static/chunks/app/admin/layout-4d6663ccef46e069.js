(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7581],{20063:(e,r,a)=>{"use strict";var s=a(47260);a.o(s,"usePathname")&&a.d(r,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(r,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(r,{useSearchParams:function(){return s.useSearchParams}})},33630:(e,r,a)=>{Promise.resolve().then(a.bind(a,67524))},40051:(e,r,a)=>{"use strict";a.d(r,{A:()=>n});var s=a(95155);function n(e){let{className:r="",shimmer:a=!0}=e;return(0,s.jsx)("div",{role:"presentation","aria-hidden":!0,className:"rounded bg-gray-200 ".concat(a?"skeleton-shimmer":"animate-pulse"," ").concat(r)})}},65380:(e,r,a)=>{"use strict";a.d(r,{A:()=>o,AuthProvider:()=>i});var s=a(95155),n=a(12115),t=a(96648);let l=(0,n.createContext)(void 0);function i(e){let{children:r}=e,[a,i]=(0,n.useState)(null),[o,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(!0),h=(0,t.U)();(0,n.useEffect)(()=>{let e,r="https://ejdwrepyuznanwujidai.supabase.co";if(!r||r.includes("placeholder")){console.error("Supabase not configured. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in Cloudflare Dashboard."),u(!1);return}h.auth.getSession().then(e=>{var r;let{data:{session:a}}=e;i(null!=(r=null==a?void 0:a.user)?r:null),(null==a?void 0:a.user)?m(a.user.id):u(!1)}).catch(e=>{console.error("Auth: Failed to get session",e),u(!1)});try{let{data:{subscription:r}}=h.auth.onAuthStateChange((e,r)=>{var a;i(null!=(a=null==r?void 0:r.user)?a:null),(null==r?void 0:r.user)?m(r.user.id):(d(null),u(!1))});e=r}catch(e){console.error("Auth: Failed to set up auth state listener",e),u(!1)}return()=>{e&&e.unsubscribe()}},[]);let m=async e=>{try{let{data:r,error:a}=await h.from("profiles").select("*").eq("id",e).single();if(a)throw a;d(r)}catch(e){}finally{u(!1)}},f=async(e,r,a,s)=>{let n=r.replace(/[^0-9]/g,""),{data:t,error:l}=await h.auth.signUp({email:e,password:a,options:{data:{full_name:s||"",phone_number:n},emailRedirectTo:void 0}});if(l){if(l.message.includes("Signups not allowed"))throw Error('Бүртгэл идэвхгүй байна. Суpabase dashboard-аас "Enable email signups" асаах шаардлагатай. Authentication → Providers → Email → Enable email signups');throw l}t.user&&(i(t.user),await m(t.user.id))},g=async(e,r)=>{let a;if(e.includes("@"))a=e.trim();else{let r=e.replace(/[^0-9]/g,"");if(!r||r.length<8)throw Error("Утасны дугаар буруу байна");let{data:s,error:n}=await h.from("profiles").select("email").eq("phone_number",r).single();if(n)throw Error("Утасны дугаараар бүртгэл олдсонгүй. И-мэйл ашиглана уу.");if(!(null==s?void 0:s.email))throw Error("Бүртгэлийн мэдээлэл дутуу байна. Та дахин бүртгүүлнэ үү.");a=s.email}let{data:s,error:n}=await h.auth.signInWithPassword({email:a,password:r});if(n)throw n},p=async()=>{let{data:e,error:r}=await h.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(r)throw r},x=async()=>{let{data:e,error:r}=await h.auth.signInWithOAuth({provider:"facebook",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(r)throw r},b=async()=>{let{error:e}=await h.auth.signOut();if(e)throw e},N=async()=>{a&&await m(a.id)},y=(null==o?void 0:o.role)==="admin";return(0,s.jsx)(l.Provider,{value:{user:a,profile:o,loading:c,signUp:f,signIn:g,signInWithGoogle:p,signInWithFacebook:x,signOut:b,refreshProfile:N,isAdmin:y},children:r})}function o(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},67524:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>u});var s=a(95155),n=a(52619),t=a.n(n),l=a(65380),i=a(20063),o=a(12115),d=a(40051);function c(){return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,s.jsx)("aside",{className:"hidden md:block w-56 border-r border-gray-200 bg-white p-4 space-y-2",children:Array.from({length:6}).map((e,r)=>(0,s.jsx)(d.A,{className:"h-10 w-full rounded-lg"},r))}),(0,s.jsxs)("main",{className:"flex-1 p-6",children:[(0,s.jsx)(d.A,{className:"h-8 w-48 mb-6"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:Array.from({length:6}).map((e,r)=>(0,s.jsx)(d.A,{className:"h-24 rounded-xl"},r))}),(0,s.jsx)(d.A,{className:"h-64 w-full rounded-xl"})]})]})}function u(e){var r,a;let{children:n}=e,{user:d,profile:u,signOut:h,loading:m}=(0,l.A)(),f=(0,i.useRouter)(),g=(0,i.usePathname)(),[p,x]=(0,o.useState)(!1),b=async()=>{try{await h(),f.push("/")}catch(e){}},N=()=>x(!1);return m?(0,s.jsx)(c,{}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,s.jsx)("header",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,s.jsx)(t(),{href:"/admin",className:"text-lg font-semibold text-gray-900",children:"Admin"}),(0,s.jsx)("button",{onClick:()=>x(!p),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Toggle menu",children:p?(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})}),p&&(0,s.jsx)("div",{className:"lg:hidden fixed inset-0 z-40 bg-black bg-opacity-50",onClick:N}),(0,s.jsx)("aside",{className:"fixed lg:relative inset-y-0 left-0 z-40 w-64 bg-white border-r border-gray-200 transition-transform duration-300 ease-in-out transform shrink-0 ".concat(p?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"hidden lg:block p-6 border-b border-gray-200",children:(0,s.jsx)(t(),{href:"/",className:"text-xl font-semibold text-gray-900",children:"Admin Dashboard"})}),(0,s.jsxs)("nav",{className:"flex-1 px-3 py-4 overflow-y-auto",children:[(0,s.jsx)("div",{className:"space-y-1",children:[{href:"/admin",label:"Хянах самбар",icon:"\uD83D\uDCCA"},{href:"/admin/products",label:"Бүтээгдэхүүн",icon:"\uD83D\uDCE6"},{href:"/admin/categories",label:"Ангилал",icon:"\uD83C\uDFF7️"},{href:"/admin/orders",label:"Захиалга",icon:"\uD83D\uDED2"},{href:"/admin/users",label:"Хэрэглэгч",icon:"\uD83D\uDC65"},{href:"/admin/referral/top6",label:"Top 6",icon:"⭐"},{href:"/admin/referral/analytics",label:"Referral Analytics",icon:"\uD83D\uDCC8"},{href:"/admin/referral/network",label:"Referral Network",icon:"\uD83C\uDF10"},{href:"/admin/spin",label:"Spin Wheel",icon:"\uD83C\uDFB0"},{href:"/admin/footer",label:"Footer",icon:"\uD83D\uDCC4"},{href:"/admin/settings",label:"Тохиргоо",icon:"⚙️"}].map(e=>{let r=g===e.href;return(0,s.jsxs)(t(),{href:e.href,onClick:N,className:"flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(r?"bg-gray-900 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,s.jsx)("span",{className:"text-lg",children:e.icon}),(0,s.jsx)("span",{children:e.label})]},e.href)})}),(0,s.jsx)("div",{className:"border-t border-gray-200 my-4"}),(0,s.jsxs)(t(),{href:"/admin/seed",onClick:N,className:"flex items-center gap-3 px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,s.jsx)("span",{className:"text-lg",children:"\uD83D\uDCBE"}),(0,s.jsx)("span",{children:"Өгөгдөл нэмэх"})]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 p-4",children:[d&&u&&(0,s.jsx)("div",{className:"mb-3 px-3 py-2 bg-gray-50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-900 flex items-center justify-center text-white font-medium text-sm",children:(null==(a=u.full_name)||null==(r=a[0])?void 0:r.toUpperCase())||"A"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:u.full_name||"Admin"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"admin"===u.role?"Админ":"Хэрэглэгч"})]})]})}),(0,s.jsx)("button",{onClick:()=>{b(),N()},className:"w-full px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors text-left mb-2",children:"Гарах"}),(0,s.jsx)(t(),{href:"/",onClick:N,className:"block px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-colors",children:"← Вэбсайт руу"})]})]})}),(0,s.jsx)("main",{className:"flex-1 min-h-screen pt-16 lg:pt-0 overflow-x-hidden",children:(0,s.jsx)("div",{className:"p-4 sm:p-6 lg:p-8",children:n})})]})}},96648:(e,r,a)=>{"use strict";a.d(r,{U:()=>i});var s=a(55417);let n="https://ejdwrepyuznanwujidai.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVqZHdyZXB5dXpuYW53dWppZGFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzNjk3NTYsImV4cCI6MjA4Mzk0NTc1Nn0.MRJe6csColzMRDpAWa-Ma99noAk6n8SbnXXHP2rNAJ4",l=null;function i(){!n||n.includes("placeholder")||n.includes("MISSING")?console.error("❌ Supabase configuration missing!\n\nNEXT_PUBLIC_SUPABASE_URL is not set.\n\nTo fix this:\n1. Go to Cloudflare Dashboard → Workers & Pages → Your Project\n2. Settings → Environment variables\n3. Add NEXT_PUBLIC_SUPABASE_URL with your Supabase project URL\n\nSee DEPLOYMENT.md for detailed instructions."):(!t||t.includes("placeholder")||t.includes("MISSING"))&&console.error("❌ Supabase configuration missing!\n\nNEXT_PUBLIC_SUPABASE_ANON_KEY is not set.\n\nTo fix this:\n1. Go to Cloudflare Dashboard → Workers & Pages → Your Project\n2. Settings → Environment variables\n3. Add NEXT_PUBLIC_SUPABASE_ANON_KEY with your Supabase anon key\n\nSee DEPLOYMENT.md for detailed instructions.");let e=!n||n.includes("placeholder")||n.includes("MISSING")?"https://placeholder.supabase.co":n,r=!t||t.includes("placeholder")||t.includes("MISSING")?"placeholder-key":t;return l||(l=(0,s.createBrowserClient)(e,r)),l}}},e=>{e.O(0,[1500,5417,2619,8441,1255,7358],()=>e(e.s=33630)),_N_E=e.O()}]);