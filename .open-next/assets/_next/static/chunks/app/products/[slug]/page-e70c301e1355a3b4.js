(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2221],{289:(e,s,r)=>{"use strict";r.d(s,{default:()=>n});var t=r(5155),a=r(63),l=r(4269),d=r(5380),i=r(2503);function n(e){let{product:s}=e,{user:r}=(0,d.A)(),{addItem:n}=(0,i._)(),c=(0,a.useRouter)(),o=(0,a.usePathname)(),x=s.description||"Манай дэлгүүр АНУ-аас бараагаа илгээдэг тул захиалга баталгаажсаны дараа 10–14 хоногийн дотор Монголд очих бөгөөд каргоны төлбөрийг тусад нь төлөхийг анхаарна уу.",m=e=>{if(!r)return void c.push("/auth/login?redirect=".concat(encodeURIComponent(o)));n({id:String(s.id),name:s.nameEn,price:s.price,originalPrice:s.originalPrice,quantity:1,slug:s.slug,brand:s.brand,imageColor:s.imageColor,brandColor:s.brandColor}),e&&c.push("/checkout")};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[s.brand&&(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["brand ",s.brand]}),(0,t.jsx)("h1",{className:"text-3xl md:text-4xl font-semibold text-gray-900 mt-2",children:s.nameEn})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"text-3xl md:text-4xl font-semibold text-gray-900",children:[(0,l.$)(s.price)," ₮"]}),s.discount>0&&(0,t.jsxs)("span",{className:"text-sm text-gray-500 line-through",children:[(0,l.$)(s.originalPrice)," ₮"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[s.discount>0&&(0,t.jsxs)("span",{className:"rounded-full bg-gray-100 px-2 py-1 text-gray-700",children:["-",s.discount,"%"]}),s.savings>0&&(0,t.jsxs)("span",{className:"text-gray-500",children:["Хэмнэлт: ",(0,l.$)(s.savings)," ₮"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Богино тайлбар"}),(0,t.jsx)("p",{className:"text-sm md:text-base text-gray-600 leading-relaxed",children:x})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,t.jsx)("button",{onClick:()=>m(!1),className:"flex-1 rounded-lg bg-gray-900 px-6 py-3 text-white text-base font-medium hover:bg-gray-800",children:"Сагслах"}),(0,t.jsx)("button",{onClick:()=>m(!0),className:"flex-1 rounded-lg border border-gray-900 px-6 py-3 text-gray-900 text-base font-medium hover:bg-gray-50",children:"Захиалах"})]})]})}},2442:(e,s,r)=>{"use strict";r.d(s,{default:()=>l});var t=r(5155),a=r(2115);function l(e){let{images:s,imageColor:r,productName:l}=e,[d,i]=(0,a.useState)(0),n=s.length||1;return(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex flex-row md:flex-col gap-2 order-2 md:order-1",children:s.map((e,s)=>(0,t.jsx)("button",{onClick:()=>i(s),className:"w-16 h-16 md:w-20 md:h-20 rounded border-2 transition-all overflow-hidden ".concat(d===s?"border-gray-900":"border-gray-200 hover:border-gray-400"),style:{backgroundColor:r},"aria-label":"View image ".concat(s+1),children:e?(0,t.jsx)("img",{src:e,alt:"".concat(l," ").concat(s+1),className:"w-full h-full object-cover"}):null},s))}),(0,t.jsx)("div",{className:"flex-1 order-1 md:order-2",children:(0,t.jsx)("div",{className:"w-full aspect-square rounded-lg border border-gray-200 bg-gray-50 flex items-center justify-center relative overflow-hidden",style:{backgroundColor:r},children:s[d]?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:s[d],alt:l||"Product Image",className:"w-full h-full object-cover"}),(0,t.jsxs)("span",{className:"absolute top-3 right-3 text-xs text-white bg-black bg-opacity-50 px-2 py-1 rounded",children:[d+1," of ",n]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"absolute top-3 right-3 text-xs text-gray-500",children:[d+1," of ",n]}),(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:l||"Product Image"})]})})})]})}},5670:(e,s,r)=>{"use strict";r.d(s,{default:()=>n});var t=r(5155),a=r(2115),l=r(5464);function d(){return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-white animate-pulse",children:[(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("div",{className:"w-16 h-8 bg-gray-200 rounded"})}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("div",{className:"w-full aspect-square bg-gray-200 rounded border border-gray-200"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-3"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-3"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-5 bg-gray-200 rounded w-20"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-16"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-12"})]})]}),(0,t.jsx)("div",{className:"pt-3 mt-auto",children:(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded-full"})})]})}function i(e){let{products:s,loading:r=!1,skeletonCount:a=10}=e;return r?(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-5 lg:gap-6",children:Array.from({length:a}).map((e,s)=>(0,t.jsx)(d,{},s))}):(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-5 lg:gap-6",children:s.map(e=>(0,t.jsx)(l.default,{product:e},e.id))})}function n(e){let{productId:s}=e,[r,l]=(0,a.useState)([]),[d,n]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/products/".concat(s,"/recommendations?limit=6"));if(e.ok){let s=await e.json();l(s.products||[])}}catch(e){}finally{n(!1)}};s&&e()},[s]),d)?(0,t.jsxs)("div",{className:"py-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Танд зөвлөж байна"}),(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Уншиж байна..."})]}):0===r.length?null:(0,t.jsxs)("div",{className:"py-8 border-t border-gray-200",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Танд зөвлөж байна"}),(0,t.jsx)(i,{products:r})]})}},7384:(e,s,r)=>{Promise.resolve().then(r.bind(r,4001)),Promise.resolve().then(r.bind(r,2442)),Promise.resolve().then(r.bind(r,289)),Promise.resolve().then(r.bind(r,5464)),Promise.resolve().then(r.bind(r,5670)),Promise.resolve().then(r.bind(r,9916))},9916:(e,s,r)=>{"use strict";r.d(s,{default:()=>n});var t=r(5155),a=r(2115),l=r(5380);function d(e){let{rating:s,onRatingChange:r,readonly:l=!1,size:d="md"}=e,[i,n]=(0,a.useState)(0),c={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"},o=()=>{l||n(0)},x=i||s;return(0,t.jsx)("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>{!l&&r&&r(e)},onMouseEnter:()=>{!l&&n(e)},onMouseLeave:o,disabled:l,className:"".concat(c[d]," ").concat(l?"cursor-default":"cursor-pointer"," transition-colors"),children:(0,t.jsx)("svg",{className:"".concat(c[d]," ").concat(e<=x?"text-yellow-400 fill-yellow-400":"text-gray-300 fill-gray-300"),fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},e))})}function i(e){let{productId:s,existingReview:r,onSuccess:i,onCancel:n}=e,{user:c}=(0,l.A)(),[o,x]=(0,a.useState)((null==r?void 0:r.rating)||0),[m,g]=(0,a.useState)((null==r?void 0:r.review_text)||""),[u,h]=(0,a.useState)(!1),[b,p]=(0,a.useState)(null);if(!c)return(0,t.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg text-center text-gray-600",children:"Нэвтэрч орж бүтээгдэхүүнийг худалдаж авсны дараа үнэлгээ өгөх боломжтой"});let y=async e=>{if(e.preventDefault(),0===o)return void p("Үнэлгээ сонгоно уу");h(!0),p(null);try{let e=r?"PUT":"POST",t=r?{review_id:r.id,rating:o,review_text:m.trim()||null}:{rating:o,review_text:m.trim()||null},a=await fetch("/api/products/".concat(s,"/reviews"),{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){let e=await a.json();throw Error(e.error||"Алдаа гарлаа")}i(),r||(x(0),g(""))}catch(e){p(e instanceof Error?e.message:"Үнэлгээ нэмэхэд алдаа гарлаа")}finally{h(!1)}};return(0,t.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Үнэлгээ"}),(0,t.jsx)(d,{rating:o,onRatingChange:x,readonly:!1})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"review-text",className:"block text-sm font-medium text-gray-700 mb-2",children:"Сэтгэгдэл (сонголттой)"}),(0,t.jsx)("textarea",{id:"review-text",value:m,onChange:e=>g(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-300 text-sm",placeholder:"Бүтээгдэхүүний талаарх санал бодлоо бичнэ үү..."})]}),b&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-600",children:b}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{type:"submit",disabled:u||0===o,className:"px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:u?"Хадгалж байна...":r?"Шинэчлэх":"Илгээх"}),n&&(0,t.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm font-medium",children:"Цуцлах"})]})]})}function n(e){let{productId:s,averageRating:r,totalReviews:n}=e,{user:c}=(0,l.A)(),[o,x]=(0,a.useState)([]),[m,g]=(0,a.useState)(!0),[u,h]=(0,a.useState)(1),[b,p]=(0,a.useState)(1),[y,f]=(0,a.useState)(null),[j,v]=(0,a.useState)(!1),N=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;g(!0);try{let t=await fetch("/api/products/".concat(s,"/reviews?page=").concat(e,"&limit=10"));if(t.ok){var r;let e=await t.json();x(e.reviews||[]),p((null==(r=e.pagination)?void 0:r.totalPages)||1)}}catch(e){}finally{g(!1)}};(0,a.useEffect)(()=>{N(u)},[s,u]);let w=async e=>{if(confirm("Энэ үнэлгээг устгахдаа итгэлтэй байна уу?"))try{(await fetch("/api/products/".concat(s,"/reviews?review_id=").concat(e),{method:"DELETE"})).ok&&N(u)}catch(e){}},C=c?o.find(e=>e.profiles.id===c.id):void 0;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Үнэлгээ ба сэтгэгдэл"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d,{rating:Math.round(r),readonly:!0,size:"lg"}),(0,t.jsx)("span",{className:"text-lg font-medium text-gray-900",children:r.toFixed(1)})]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["(",n," үнэлгээ)"]})]})]}),c&&!C&&(0,t.jsx)("button",{onClick:()=>v(!j),className:"px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 text-sm font-medium",children:j?"Цуцлах":"Үнэлгээ нэмэх"})]}),j&&c&&!C&&(0,t.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg",children:(0,t.jsx)(i,{productId:s,onSuccess:()=>{v(!1),N(u)},onCancel:()=>v(!1)})}),y&&C&&(0,t.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg",children:(0,t.jsx)(i,{productId:s,existingReview:C,onSuccess:()=>{f(null),N(u)},onCancel:()=>f(null)})}),m?(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Уншиж байна..."}):0===o.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Хараахан үнэлгээ байхгүй байна"}):(0,t.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,t.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.profiles.avatar_url?(0,t.jsx)("img",{src:e.profiles.avatar_url,alt:e.profiles.full_name||"User",className:"w-10 h-10 rounded-full"}):(0,t.jsx)("span",{className:"text-gray-600 text-sm font-medium",children:(e.profiles.full_name||"U")[0].toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.profiles.full_name||"Хэрэглэгч"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:(e=>{let s=new Date(e);return new Intl.DateTimeFormat("mn-MN",{year:"numeric",month:"long",day:"numeric"}).format(s)})(e.created_at)})]})]}),(null==c?void 0:c.id)===e.profiles.id&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>f(y===e.id?null:e.id),className:"text-sm text-gray-600 hover:text-gray-900",children:"Засах"}),(0,t.jsx)("button",{onClick:()=>w(e.id),className:"text-sm text-red-600 hover:text-red-900",children:"Устгах"})]})]}),(0,t.jsx)(d,{rating:e.rating,readonly:!0,size:"sm"}),e.review_text&&(0,t.jsx)("p",{className:"mt-3 text-sm text-gray-700",children:e.review_text})]},e.id))}),b>1&&(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>h(e=>Math.max(1,e-1)),disabled:1===u,className:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Өмнөх"}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[u," / ",b]}),(0,t.jsx)("button",{onClick:()=>h(e=>Math.min(b,e+1)),disabled:u===b,className:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Дараах"})]})]})}}},e=>{e.O(0,[5417,2619,3528,8441,1255,7358],()=>e(e.s=7384)),_N_E=e.O()}]);