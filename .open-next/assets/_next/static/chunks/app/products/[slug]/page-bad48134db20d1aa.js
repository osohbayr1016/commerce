(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{63:(e,r,t)=>{"use strict";var s=t(7260);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},444:(e,r,t)=>{"use strict";t.d(r,{default:()=>n});var s=t(5155),a=t(2115);function l(e){return new Intl.NumberFormat("mn-MN").format(e)}function n(e){let{product:r}=e,[t,n]=(0,a.useState)(null),[o,i]=(0,a.useState)(1),d=e=>{i(r=>Math.max(1,Math.min(10,r+e)))};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold text-gray-900 mb-2",children:r.nameEn}),(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("p",{className:"text-base text-gray-600",children:r.nameMn}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:r.sku})]})]}),(0,s.jsx)("div",{className:"w-20 h-10 rounded border border-gray-200",style:{backgroundColor:r.brandColor}})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-baseline gap-3 mb-2",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Онлайн авах үнэ"}),r.discount>0&&(0,s.jsxs)("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:["-",r.discount,"%"]})]}),(0,s.jsx)("div",{className:"flex items-baseline gap-3",children:(0,s.jsxs)("span",{className:"text-3xl md:text-4xl font-semibold text-gray-900",children:[l(r.price)," ₮"]})}),r.savings>0&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Хэмнэлт: ",l(r.savings)," ₮"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Анхны үнэ"}),(0,s.jsxs)("p",{className:"text-xl md:text-2xl text-gray-400 line-through",children:[l(r.originalPrice)," ₮"]})]})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("label",{className:"text-base md:text-lg font-medium text-gray-900",children:["Гутлын размер: ",t||"Сонгоно уу"]}),(0,s.jsxs)("a",{href:"#",className:"text-sm text-gray-600 hover:text-gray-900 underline flex items-center gap-1",children:["Хэмжээний заавар",(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-6 gap-3",children:r.sizes.map(e=>(0,s.jsx)("button",{onClick:()=>n(e),className:"py-3.5 px-4 border-2 rounded-lg text-base md:text-lg font-medium transition-all ".concat(t===e?"border-gray-900 bg-gray-100 text-gray-900 shadow-sm":"border-gray-300 text-gray-700 hover:border-gray-500 hover:bg-gray-50"),children:e},e))})]})}),r.hasFinancing&&(0,s.jsx)("div",{className:"border-t border-dashed border-gray-300 pt-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("svg",{className:"w-6 h-6 text-gray-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("p",{className:"text-sm text-gray-700",children:"Та зээлийн нөхцөлөөр энэхүү барааг авах боломжтой. . powered by TDB"})]})}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[(0,s.jsx)("button",{onClick:()=>d(-1),className:"px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors","aria-label":"Decrease quantity",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,s.jsx)("input",{type:"number",min:"1",max:"10",value:o,readOnly:!0,className:"w-16 text-center text-base font-medium text-gray-900 border-x border-gray-300 py-3"}),(0,s.jsx)("button",{onClick:()=>d(1),className:"px-4 py-3 text-gray-700 hover:bg-gray-100 transition-colors","aria-label":"Increase quantity",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,s.jsx)("button",{disabled:!t,className:"flex-1 py-4 px-6 rounded-lg text-base md:text-lg font-medium transition-colors ".concat(t?"bg-gray-900 text-white hover:bg-gray-800":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:t?"Сагсанд хийх":"Хэмжээ сонгоно уу"}),(0,s.jsx)("button",{className:"px-6 py-4 border-2 border-gray-300 rounded-lg hover:border-gray-400 transition-colors","aria-label":"Add to wishlist",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]})]})]})}},2007:(e,r,t)=>{Promise.resolve().then(t.bind(t,4001)),Promise.resolve().then(t.bind(t,2442)),Promise.resolve().then(t.bind(t,444))},2442:(e,r,t)=>{"use strict";t.d(r,{default:()=>l});var s=t(5155),a=t(2115);function l(e){let{images:r,imageColor:t,productName:l}=e,[n,o]=(0,a.useState)(0);return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,s.jsx)("div",{className:"flex flex-row md:flex-col gap-2 order-2 md:order-1",children:r.map((e,r)=>(0,s.jsx)("button",{onClick:()=>o(r),className:"w-16 h-16 md:w-20 md:h-20 rounded border-2 transition-all ".concat(n===r?"border-gray-900":"border-gray-200 hover:border-gray-400"),style:{backgroundColor:t},"aria-label":"View image ".concat(r+1)},r))}),(0,s.jsx)("div",{className:"flex-1 order-1 md:order-2",children:(0,s.jsx)("div",{className:"w-full aspect-square rounded-lg border border-gray-200 bg-gray-50 flex items-center justify-center",style:{backgroundColor:t},children:(0,s.jsxs)("span",{className:"text-gray-400 text-sm",children:["Product Image ",n+1]})})})]})}},4001:(e,r,t)=>{"use strict";t.d(r,{default:()=>d});var s=t(5155),a=t(2115),l=t(2619),n=t.n(l),o=t(63),i=t(5380);function d(){var e,r,t,l;let[d,c]=(0,a.useState)(!1),u=(0,a.useRef)(null),{user:x,profile:m,signOut:h,isAdmin:g}=(0,i.A)(),p=(0,o.useRouter)();(0,a.useEffect)(()=>{function e(e){u.current&&!u.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let b=async()=>{try{await h(),c(!1),p.push("/")}catch(e){console.error("Error signing out:",e)}};return x?(0,s.jsxs)("div",{className:"relative",ref:u,children:[(0,s.jsxs)("button",{onClick:()=>c(!d),className:"flex items-center space-x-2 text-gray-700 hover:text-gray-900",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-900 flex items-center justify-center text-white font-medium text-sm",children:(null==m||null==(r=m.full_name)||null==(e=r[0])?void 0:e.toUpperCase())||"U"}),(0,s.jsx)("svg",{className:"w-4 h-4 transition-transform ".concat(d?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(null==m?void 0:m.full_name)||"Хэрэглэгч"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:(null==(t=x.user_metadata)?void 0:t.phone_number)||x.phone||(null==(l=x.email)?void 0:l.replace("@phone.app",""))}),g&&(0,s.jsx)("span",{className:"inline-block mt-2 px-2 py-1 text-xs font-medium bg-gray-900 text-white rounded",children:"Админ"})]}),(0,s.jsxs)("div",{className:"py-2",children:[(0,s.jsx)(n(),{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:()=>c(!1),children:"\uD83D\uDC64 Миний профайл"}),(0,s.jsx)(n(),{href:"/profile?tab=orders",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:()=>c(!1),children:"\uD83D\uDCE6 Миний захиалга"}),(0,s.jsx)(n(),{href:"/profile?tab=wishlist",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:()=>c(!1),children:"❤️ Хадгалсан"}),g&&(0,s.jsx)(n(),{href:"/admin",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:()=>c(!1),children:"Админ самбар"})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 pt-2",children:(0,s.jsx)("button",{onClick:b,className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:"Гарах"})})]})]}):(0,s.jsx)(n(),{href:"/auth/login",className:"text-gray-700 hover:text-gray-900 text-sm md:text-base whitespace-nowrap font-medium",children:"нэвтрэх/бүртгүүлэх"})}},5380:(e,r,t)=>{"use strict";t.d(r,{A:()=>i,AuthProvider:()=>o});var s=t(5155),a=t(2115),l=t(6648);let n=(0,a.createContext)(void 0);function o(e){let{children:r}=e,[t,o]=(0,a.useState)(null),[i,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),x=(0,l.U)();(0,a.useEffect)(()=>{x.auth.getSession().then(e=>{var r;let{data:{session:t}}=e;o(null!=(r=null==t?void 0:t.user)?r:null),(null==t?void 0:t.user)?m(t.user.id):u(!1)});let{data:{subscription:e}}=x.auth.onAuthStateChange((e,r)=>{var t;o(null!=(t=null==r?void 0:r.user)?t:null),(null==r?void 0:r.user)?m(r.user.id):(d(null),u(!1))});return()=>e.unsubscribe()},[]);let m=async e=>{try{let{data:r,error:t}=await x.from("profiles").select("*").eq("id",e).single();if(t)throw t;d(r)}catch(e){console.error("Error fetching profile:",e)}finally{u(!1)}},h=async(e,r,t,s)=>{let a=r.replace(/[^0-9]/g,""),{data:l,error:n}=await x.auth.signUp({email:e,password:t,options:{data:{full_name:s||"",phone_number:a},emailRedirectTo:void 0}});if(n)throw n;l.user&&(o(l.user),await m(l.user.id))},g=async(e,r)=>{let t;if(e.includes("@"))console.log("Login with email:",t=e.trim());else{let r=e.replace(/[^0-9]/g,"");if(console.log("Login with phone:",r),!r||r.length<8)throw Error("Утасны дугаар буруу байна");let{data:s,error:a}=await x.from("profiles").select("email").eq("phone_number",r).single();if(console.log("Profile lookup result:",{profile:s,profileError:a}),a)throw console.error("Profile lookup error:",a),Error("Утасны дугаараар бүртгэл олдсонгүй. И-мэйл ашиглана уу.");if(!(null==s?void 0:s.email))throw Error("Бүртгэлийн мэдээлэл дутуу байна. Та дахин бүртгүүлнэ үү.");console.log("Using email from profile:",t=s.email)}let{data:s,error:a}=await x.auth.signInWithPassword({email:t,password:r});if(a)throw console.error("Supabase auth error:",a),a;console.log("Login successful!")},p=async()=>{let{data:e,error:r}=await x.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(r)throw r},b=async()=>{let{error:e}=await x.auth.signOut();if(e)throw e},y=(null==i?void 0:i.role)==="admin";return(0,s.jsx)(n.Provider,{value:{user:t,profile:i,loading:c,signUp:h,signIn:g,signInWithGoogle:p,signOut:b,isAdmin:y},children:r})}function i(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6648:(e,r,t)=>{"use strict";t.d(r,{U:()=>a});var s=t(5417);function a(){let e="https://ejdwrepyuznanwujidai.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVqZHdyZXB5dXpuYW53dWppZGFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzNjk3NTYsImV4cCI6MjA4Mzk0NTc1Nn0.MRJe6csColzMRDpAWa-Ma99noAk6n8SbnXXHP2rNAJ4";return e&&r?(0,s.createBrowserClient)(e,r):(console.error("Missing Supabase environment variables"),(0,s.createBrowserClient)("https://placeholder.supabase.co","placeholder-key"))}}},e=>{e.O(0,[417,619,441,493,358],()=>e(e.s=2007)),_N_E=e.O()}]);