(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71052,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(57951);function r(){let{user:e}=(0,a.useAuth)(),[r,l]=(0,t.useState)([]),[d,i]=(0,t.useState)(0),[n,x]=(0,t.useState)(!0),[c,o]=(0,t.useState)(null),[m,h]=(0,t.useState)(""),[g,p]=(0,t.useState)(""),[y,u]=(0,t.useState)(""),[b,j]=(0,t.useState)(0),f=async()=>{x(!0),h("");try{let e=new URLSearchParams({limit:String(20),offset:String(20*b)});y.trim()&&e.set("q",y.trim());let s=await fetch(`/api/admin/users?${e}`),t=await s.json();if(!s.ok)throw Error(t.error||"Алдаа");l(t.users||[]),i(t.total??0)}catch(e){h(e instanceof Error?e.message:"Хэрэглэгч татахад алдаа гарлаа")}finally{x(!1)}};(0,t.useEffect)(()=>{f()},[b,y]);let N=async(e,s)=>{o(e),h(""),p("");try{let t=await fetch(`/api/admin/users/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:s})}),a=await t.json();if(!t.ok)throw Error(a.error||"Алдаа");p(`Эрх шинэчлэгдлээ: ${"admin"===s?"Админ":"Хэрэглэгч"}`),f()}catch(e){h(e instanceof Error?e.message:"Эрх шинэчлэхэд алдаа")}finally{o(null)}},v=e=>e?new Date(e).toLocaleDateString("mn-MN",{dateStyle:"short"}):"—";return(0,s.jsxs)("div",{className:"space-y-4 sm:space-y-6 max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Хэрэглэгчийн удирдлага"}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Бүртгэлтэй хэрэглэгчдийг харах, эрх өгөх/хасах"})]}),m&&(0,s.jsx)("div",{className:"p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:m}),g&&(0,s.jsx)("div",{className:"p-3 sm:p-4 bg-green-50 border border-green-200 rounded-lg text-sm text-green-700",children:g}),(0,s.jsx)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:(0,s.jsx)("input",{type:"search",placeholder:"Нэр хайх...",value:y,onChange:e=>{u(e.target.value),j(0)},className:"flex-1 px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-900 focus:border-transparent"})}),n?(0,s.jsx)("div",{className:"p-12 text-center text-gray-500",children:"Ачааллаж байна..."}):0===r.length?(0,s.jsx)("div",{className:"p-12 text-center text-gray-500",children:"Хэрэглэгч олдсонгүй"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"hidden lg:block bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-left",children:[(0,s.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Нэр"}),(0,s.jsx)("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Имэйл"}),(0,s.jsx)("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Утас"}),(0,s.jsx)("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Эрх"}),(0,s.jsx)("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Бүртгэсэн"}),(0,s.jsx)("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Үйлдэл"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:r.map(t=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-4 py-3",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:t.full_name||"—"}),t.promo_code&&(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["Promo: ",t.promo_code]})]}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-700 text-sm",children:t.email||"—"}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-700 text-sm",children:t.phone_number||"—"}),(0,s.jsxs)("td",{className:"px-4 py-3",children:[(0,s.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${"admin"===t.role?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-700"}`,children:"admin"===t.role?"Админ":"Хэрэглэгч"}),t.is_top6&&(0,s.jsx)("span",{className:"ml-1 inline-flex px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",children:"Top 6"})]}),(0,s.jsx)("td",{className:"px-4 py-3 text-gray-600 text-sm",children:v(t.created_at)}),(0,s.jsx)("td",{className:"px-4 py-3",children:"admin"===t.role?e?.id===t.id?(0,s.jsx)("span",{className:"text-gray-400 text-sm",children:"Та"}):(0,s.jsx)("button",{onClick:()=>N(t.id,"user"),disabled:!!c,className:"text-sm text-red-600 hover:underline disabled:opacity-50",children:c===t.id?"...":"Эрх хасах"}):(0,s.jsx)("button",{onClick:()=>N(t.id,"admin"),disabled:!!c,className:"text-sm text-indigo-600 hover:underline disabled:opacity-50",children:c===t.id?"...":"Админ болгох"})})]},t.id))})]})})}),(0,s.jsx)("div",{className:"lg:hidden space-y-3",children:r.map(t=>(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:t.full_name||"—"}),t.promo_code&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Promo: ",t.promo_code]})]}),(0,s.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,s.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${"admin"===t.role?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-700"}`,children:"admin"===t.role?"Админ":"Хэрэглэгч"}),t.is_top6&&(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",children:"Top 6"})]})]}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Имэйл:"}),(0,s.jsx)("span",{className:"text-gray-900 truncate ml-2",children:t.email||"—"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Утас:"}),(0,s.jsx)("span",{className:"text-gray-900",children:t.phone_number||"—"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Бүртгэсэн:"}),(0,s.jsx)("span",{className:"text-gray-900",children:v(t.created_at)})]})]}),(0,s.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:"admin"===t.role?e?.id===t.id?(0,s.jsx)("span",{className:"text-gray-400 text-sm",children:"Та"}):(0,s.jsx)("button",{onClick:()=>N(t.id,"user"),disabled:!!c,className:"w-full py-2 text-sm font-medium text-red-600 bg-red-50 rounded-lg hover:bg-red-100 disabled:opacity-50 transition-colors",children:c===t.id?"Уншиж байна...":"Эрх хасах"}):(0,s.jsx)("button",{onClick:()=>N(t.id,"admin"),disabled:!!c,className:"w-full py-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-lg hover:bg-indigo-100 disabled:opacity-50 transition-colors",children:c===t.id?"Уншиж байна...":"Админ болгох"})})]},t.id))})]}),d>20&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 px-4 py-3 bg-white border border-gray-200 rounded-lg",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["Нийт ",d," хэрэглэгч"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>j(e=>Math.max(0,e-1)),disabled:0===b,className:"px-4 py-2 text-sm font-medium border border-gray-300 rounded-lg disabled:opacity-50 hover:bg-gray-100 transition-colors",children:"Өмнөх"}),(0,s.jsx)("button",{onClick:()=>j(e=>e+1),disabled:(b+1)*20>=d,className:"px-4 py-2 text-sm font-medium border border-gray-300 rounded-lg disabled:opacity-50 hover:bg-gray-100 transition-colors",children:"Дараах"})]})]})]})}e.s(["default",()=>r])}]);