(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,89271,e=>{"use strict";function t(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;if(e&&"object"==typeof e){if("message"in e)return String(e.message);if("msg"in e)return String(e.msg)}return"Тодорхойгүй алдаа гарлаа"}e.s(["getErrorMessage",()=>t])},69888,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(11795),s=e.i(89271);function n({editing:e,formData:r,onFormChange:a,onSubmit:s,onCancel:n,loading:l}){let i=async e=>{e.preventDefault(),await s()};return(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:e?"Ангилал засах":"Шинэ ангилал нэмэх"}),(0,t.jsxs)("form",{onSubmit:i,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Нэр"}),(0,t.jsx)("input",{type:"text",value:r.name,onChange:e=>a("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"English Name"}),(0,t.jsx)("input",{type:"text",value:r.name_en,onChange:e=>a("name_en",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Монгол нэр"}),(0,t.jsx)("input",{type:"text",value:r.name_mn,onChange:e=>a("name_mn",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug"}),(0,t.jsx)("input",{type:"text",value:r.slug,onChange:e=>a("slug",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),(0,t.jsx)("input",{type:"number",value:r.display_order,onChange:e=>a("display_order",Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:r.is_active,onChange:e=>a("is_active",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Active"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:r.show_in_header,onChange:e=>a("show_in_header",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Show in Header Navigation"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Saving...":e?"Update":"Create"}),e&&(0,t.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]})]})}var l=e.i(74080);function i({categories:e,loading:a,onEdit:s,onDelete:n,onToggleActive:i}){let[d,c]=(0,r.useState)(null),[o,m]=(0,r.useState)(!1),[u,x]=(0,r.useState)(null),g=null!=d?e.find(e=>e.id===d):null;(0,r.useEffect)(()=>(null!=d?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[d]),(0,r.useEffect)(()=>{if(null==d)return;let e=e=>{"Escape"!==e.key||o||c(null)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[d,o]);let h=async()=>{if(null!=d){m(!0),x(null);try{await n(d),c(null)}catch(e){x(e instanceof Error?e.message:"Устгахад алдаа гарлаа")}finally{m(!1)}}};return a?(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,t.jsx)("p",{className:"text-gray-600",children:"Loading categories..."})}):0===e.length?(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,t.jsx)("p",{className:"text-gray-600",children:"No categories found"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slug"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Header"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),e.name_en&&(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.name_en})]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.slug}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.display_order}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("button",{onClick:()=>i(e.id,!e.is_active),className:`px-2 py-1 text-xs font-medium rounded-full ${e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.is_active?"Active":"Inactive"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.show_in_header?"Yes":"No"}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,t.jsx)("button",{onClick:()=>s(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>c(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id))})]})}),null!=d&&"u">typeof document&&(0,l.createPortal)((0,t.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-labelledby":"category-delete-title",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!o&&c(null),"aria-hidden":"true"}),(0,t.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[(0,t.jsx)("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-red-100",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,t.jsx)("h3",{id:"category-delete-title",className:"mt-4 text-center text-lg font-semibold text-gray-900",children:"Ангилал устгах"}),(0,t.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:['Та "',g?.name??"",'" ангилалыг устгахдаа итгэлтэй байна уу? Энэ үйлдлийг буцааж болохгүй.']}),u&&(0,t.jsx)("p",{className:"mt-2 text-center text-sm text-red-600",children:u}),(0,t.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>!o&&c(null),disabled:o,className:"flex-1 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Болих"}),(0,t.jsx)("button",{type:"button",onClick:h,disabled:o,className:"flex-1 rounded-lg bg-red-600 px-4 py-2.5 text-sm font-medium text-white hover:bg-red-700 disabled:opacity-50",children:o?"Устгаж байна...":"Устгах"})]})]})]}),document.body)]})}function d(){let[e,l]=(0,r.useState)([]),[d,c]=(0,r.useState)(!0),[o,m]=(0,r.useState)(null),[u,x]=(0,r.useState)({name:"",name_en:"",name_mn:"",slug:"",is_active:!0,display_order:0,show_in_header:!1}),[g,h]=(0,r.useState)(""),p=(0,a.createClient)(),y=(0,r.useCallback)(async()=>{try{let{data:e,error:t}=await p.from("categories").select("id, name, name_en, name_mn, slug, is_active, display_order").order("display_order",{ascending:!0});if(t)throw t;l(e||[])}catch(e){}finally{c(!1)}},[p]);function b(){x({name:"",name_en:"",name_mn:"",slug:"",is_active:!0,display_order:0,show_in_header:!1}),m(null),h("")}function f(e){let{name:t,name_en:r,name_mn:a,slug:s,is_active:n,display_order:l,show_in_header:i}=u,d={name:t,name_en:r||null,name_mn:a||null,slug:s,is_active:n,display_order:l};return e&&(d.show_in_header=i),d}async function j(){c(!0);try{if(o){let e=f(!0),t=await fetch(`/api/admin/categories/${o}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json().catch(()=>({}));if(!t.ok)throw Error(r.error||"Update failed");h("Category updated successfully")}else{let e=f(!0),t=await p.from("categories").insert([e]);if(t.error?.message?.includes("show_in_header")&&t.error?.message?.includes("schema cache")&&(t=await p.from("categories").insert([f(!1)])),t.error)throw t.error;h("Category created successfully")}b(),await y()}catch(e){h(`Error: ${(0,s.getErrorMessage)(e)}`)}finally{c(!1)}}async function v(e){try{let t=await fetch(`/api/admin/categories/${e}`,{method:"DELETE"}),r=await t.json().catch(()=>({}));if(!t.ok)throw Error(r.error||"Delete failed");h("Category deleted successfully"),await y()}catch(e){h(`Error: ${(0,s.getErrorMessage)(e)}`)}}async function w(e,t){try{let r=await fetch(`/api/admin/categories/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:t})}),a=await r.json().catch(()=>({}));if(!r.ok)throw Error(a.error||"Update failed");await y()}catch(e){h(`Error: ${(0,s.getErrorMessage)(e)}`)}}return(0,r.useEffect)(()=>{y()},[y]),(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-semibold text-gray-900 mb-2",children:"Ангилал удирдах"}),(0,t.jsx)("p",{className:"text-base text-gray-600",children:"Бүтээгдэхүүний ангилал нэмэх, засах"})]}),g&&(0,t.jsx)("div",{className:`mb-6 p-4 rounded-lg ${g.includes("Error")?"bg-red-50 text-red-800":"bg-green-50 text-green-800"}`,children:g}),(0,t.jsx)(n,{editing:o,formData:u,onFormChange:function(e,t){x(r=>({...r,[e]:t}))},onSubmit:j,onCancel:b,loading:d}),(0,t.jsx)(i,{categories:e,loading:d,onEdit:function(e){x({name:e.name,name_en:e.name_en||"",name_mn:e.name_mn||"",slug:e.slug,is_active:e.is_active??!0,display_order:e.display_order||0,show_in_header:e.show_in_header||!1}),m(e.id),h("")},onDelete:v,onToggleActive:w})]})}e.s(["default",()=>d],69888)}]);