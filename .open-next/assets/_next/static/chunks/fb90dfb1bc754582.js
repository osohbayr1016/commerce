(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,89271,e=>{"use strict";function r(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;if(e&&"object"==typeof e){if("message"in e)return String(e.message);if("msg"in e)return String(e.msg)}return"Тодорхойгүй алдаа гарлаа"}e.s(["getErrorMessage",()=>r])},35016,e=>{"use strict";var r=e.i(43476),a=e.i(71645),s=e.i(43066);function t({images:e,onImagesChange:t}){let[n,l]=(0,a.useState)(!1),[o,i]=(0,a.useState)(0),[c,d]=(0,a.useState)(!1),g=(0,a.useRef)(null),u=(0,s.useModal)(),b=(0,a.useCallback)(async r=>{if(r&&0!==r.length){l(!0),i(0);try{let a=new FormData;Array.from(r).forEach(e=>{a.append("files",e)});let s=await fetch("/api/images/upload",{method:"POST",body:a});if(!s.ok){let e=await s.json(),r=e.details?`${e.error}: ${Array.isArray(e.details)?e.details.join(", "):e.details}`:e.error||"Upload failed";throw Error(r)}let n=(await s.json()).images.map(e=>e.url);t([...e,...n]),i(100)}catch(e){u.showError("Upload алдаа",e instanceof Error?e.message:"Upload failed")}finally{l(!1),i(0),g.current&&(g.current.value="")}}},[e,t]),m=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?d(!0):"dragleave"===e.type&&d(!1)},[]),x=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&b(e.dataTransfer.files)},[b]);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Зураг *"}),(0,r.jsxs)("div",{onDragEnter:m,onDragLeave:m,onDragOver:m,onDrop:x,className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${c?"border-gray-900 bg-gray-50":"border-gray-300 bg-white hover:border-gray-400"} ${n?"opacity-50 pointer-events-none":""}`,children:[(0,r.jsx)("input",{ref:g,type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:e=>{e.target.files&&e.target.files.length>0&&b(e.target.files)},className:"hidden",disabled:n}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Зураг чирж тавих эсвэл"," ",(0,r.jsx)("button",{type:"button",onClick:()=>g.current?.click(),className:"text-gray-900 font-medium underline hover:text-gray-700",children:"файл сонгох"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"JPG, PNG, WEBP (Хамгийн ихдээ 10MB)"})]}),n&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-gray-900 h-2 rounded-full transition-all",style:{width:`${o}%`}})})})]}),e.length>0&&(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:e.map((a,s)=>(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("img",{src:a,alt:`Product ${s+1}`,className:"w-full aspect-square object-cover rounded-lg border border-gray-200"}),(0,r.jsx)("button",{type:"button",onClick:()=>{t(e.filter((e,r)=>r!==s))},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Remove image",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s))})]})}e.s(["default",()=>t])},52767,e=>{"use strict";var r=e.i(43476),a=e.i(71645),s=e.i(11795),t=e.i(18566),n=e.i(89271),l=e.i(35016);function o({product:e}){let[o,i]=(0,a.useState)({name_en:e?.name_en||"",name_mn:e?.name_mn||"",brand:e?.brand||"",sku:e?.sku||"",price:e?.price||0,original_price:e?.original_price||0,discount:e?.discount||0,stock:e?.stock||0,sizes:e?.sizes?.join(",")||"",description:e?.description||"",subcategory:e?.subcategory||"",category_id:e?.category_id||"",brand_color:e?.brand_color||"#F5F5F5",image_color:e?.image_color||"#FAFAFA",has_financing:e?.has_financing||!1}),[c,d]=(0,a.useState)([]),[g,u]=(0,a.useState)(!1),[b,m]=(0,a.useState)(""),[x,p]=(0,a.useState)(e?.images||[]),f=(0,t.useRouter)(),h=(0,s.createClient)();async function y(){let{data:e}=await h.from("categories").select("*").order("name",{ascending:!0});e&&d(e)}function j(e){let{name:r,value:a,type:s}=e.target;"checkbox"===s?i(a=>({...a,[r]:e.target.checked})):i(e=>({...e,[r]:a}))}async function k(r){r.preventDefault(),u(!0),m("");try{let r=o.sizes?o.sizes.split(",").map(e=>parseInt(e.trim())).filter(e=>!isNaN(e)):[],a={title:o.name_en||o.name_mn||"Untitled Product",name_en:o.name_en,name_mn:o.name_mn,brand:o.brand,sku:o.sku,price:parseInt(o.price.toString()),original_price:parseInt(o.original_price.toString()),discount:parseInt(o.discount.toString()),stock:parseInt(o.stock.toString()),sizes:r,description:o.description,subcategory:o.subcategory,category_id:o.category_id?parseInt(o.category_id.toString()):null,brand_color:o.brand_color,image_color:o.image_color,has_financing:o.has_financing,images:x};if(e?.id){let{error:r}=await h.from("products").update(a).eq("id",e.id);if(r)throw r;m("Бүтээгдэхүүн амжилттай шинэчлэгдлээ!")}else{let{error:e}=await h.from("products").insert([a]);if(e)throw e;m("Бүтээгдэхүүн амжилттай нэмэгдлээ!")}setTimeout(()=>{f.push("/admin/products"),f.refresh()},1500)}catch(e){m(`Алдаа гарлаа: ${(0,n.getErrorMessage)(e)}`)}finally{u(!1)}}return(0,a.useEffect)(()=>{y()},[]),(0,r.jsxs)("form",{onSubmit:k,className:"max-w-4xl space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-black mb-4",children:"Зураг"}),(0,r.jsx)(l.default,{images:x,onImagesChange:p})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-black mb-4",children:"Үндсэн мэдээлэл"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Нэр (Англи) *"}),(0,r.jsx)("input",{type:"text",name:"name_en",value:o.name_en,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Нэр (Монгол) *"}),(0,r.jsx)("input",{type:"text",name:"name_mn",value:o.name_mn,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",required:!0})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Брэнд *"}),(0,r.jsx)("input",{type:"text",name:"brand",value:o.brand,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"SKU *"}),(0,r.jsx)("input",{type:"text",name:"sku",value:o.sku,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Тайлбар"}),(0,r.jsx)("textarea",{name:"description",value:o.description,onChange:j,rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400"})]})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-black mb-4",children:"Үнийн мэдээлэл"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Үнэ *"}),(0,r.jsx)("input",{type:"number",name:"price",value:o.price,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Анхны үнэ *"}),(0,r.jsx)("input",{type:"number",name:"original_price",value:o.original_price,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Хөнгөлөлт (%)"}),(0,r.jsx)("input",{type:"number",name:"discount",value:o.discount,onChange:j,min:"0",max:"100",className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-black mb-4",children:"Ангилал & Нөөц"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Ангилал"}),(0,r.jsxs)("select",{name:"category_id",value:o.category_id,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",children:[(0,r.jsx)("option",{value:"",children:"Сонгоно уу"}),c.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Дэд ангилал"}),(0,r.jsx)("input",{type:"text",name:"subcategory",value:o.subcategory,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",placeholder:"Жишээ: Гутал"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Нөөц *"}),(0,r.jsx)("input",{type:"number",name:"stock",value:o.stock,onChange:j,min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-base font-semibold text-black mb-2",children:"Размерууд (таслалаар тусгаарлах)"}),(0,r.jsx)("input",{type:"text",name:"sizes",value:o.sizes,onChange:j,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-gray-400",placeholder:"35, 36, 37, 38, 39, 40"})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",name:"has_financing",checked:o.has_financing,onChange:j,className:"w-5 h-5 text-gray-900 border-gray-300 rounded focus:ring-gray-400"}),(0,r.jsx)("label",{className:"ml-3 text-base font-medium text-black",children:"Зээлийн боломжтой"})]})]}),b&&(0,r.jsx)("div",{className:`p-4 rounded-lg ${b.includes("амжилттай")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:b}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{type:"submit",disabled:g,className:`px-6 py-3 rounded-lg text-base font-medium transition-colors ${g?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:g?"Хадгалж байна...":e?.id?"Шинэчлэх":"Нэмэх"}),(0,r.jsx)("button",{type:"button",onClick:()=>f.back(),className:"px-6 py-3 border border-gray-300 rounded-lg text-base font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Цуцлах"})]})]})}e.s(["default",()=>o])}]);