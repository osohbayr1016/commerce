(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,89271,e=>{"use strict";function t(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;if(e&&"object"==typeof e){if("message"in e)return String(e.message);if("msg"in e)return String(e.msg)}return"Тодорхойгүй алдаа гарлаа"}e.s(["getErrorMessage",()=>t])},69888,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(11795),s=e.i(89271);function n({editing:e,formData:r,onFormChange:a,onSubmit:s,onCancel:n,loading:i}){let l=async e=>{e.preventDefault(),await s()};return(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:e?"Ангилал засах":"Шинэ ангилал нэмэх"}),(0,t.jsxs)("form",{onSubmit:l,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Нэр"}),(0,t.jsx)("input",{type:"text",value:r.name,onChange:e=>a("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"English Name"}),(0,t.jsx)("input",{type:"text",value:r.name_en,onChange:e=>a("name_en",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Монгол нэр"}),(0,t.jsx)("input",{type:"text",value:r.name_mn,onChange:e=>a("name_mn",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug"}),(0,t.jsx)("input",{type:"text",value:r.slug,onChange:e=>a("slug",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),(0,t.jsx)("input",{type:"number",value:r.display_order,onChange:e=>a("display_order",Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:r.is_active,onChange:e=>a("is_active",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Active"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:r.show_in_header,onChange:e=>a("show_in_header",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Show in Header Navigation"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Saving...":e?"Update":"Create"}),e&&(0,t.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]})]})}var i=e.i(43066);function l({categories:e,loading:r,onEdit:a,onDelete:s,onToggleActive:n}){let l=(0,i.useModal)();return r?(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,t.jsx)("p",{className:"text-gray-600",children:"Loading categories..."})}):0===e.length?(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:(0,t.jsx)("p",{className:"text-gray-600",children:"No categories found"})}):(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slug"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Header"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),e.name_en&&(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.name_en})]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.slug}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.display_order}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("button",{onClick:()=>n(e.id,!e.is_active),className:`px-2 py-1 text-xs font-medium rounded-full ${e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.is_active?"Active":"Inactive"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.show_in_header?"Yes":"No"}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,t.jsx)("button",{onClick:()=>a(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>{l.showConfirm("Ангилал устгах","Та энэ ангилалыг устгахдаа итгэлтэй байна уу?",()=>s(e.id),"Устгах","Болих")},className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id))})]})})}function c(){let[e,i]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[o,m]=(0,r.useState)(null),[g,x]=(0,r.useState)({name:"",name_en:"",name_mn:"",slug:"",is_active:!0,display_order:0,show_in_header:!1}),[u,h]=(0,r.useState)(""),p=(0,a.createClient)(),y=(0,r.useCallback)(async()=>{try{let{data:e,error:t}=await p.from("categories").select("*").order("display_order",{ascending:!0});if(t)throw t;i(e||[])}catch(e){}finally{d(!1)}},[p]);function b(){x({name:"",name_en:"",name_mn:"",slug:"",is_active:!0,display_order:0,show_in_header:!1}),m(null),h("")}function f(e){let{name:t,name_en:r,name_mn:a,slug:s,is_active:n,display_order:i,show_in_header:l}=g,c={name:t,name_en:r||null,name_mn:a||null,slug:s,is_active:n,display_order:i};return e&&(c.show_in_header=l),c}async function j(){d(!0);try{if(o){let e=f(!0),t=await fetch(`/api/admin/categories/${o}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json().catch(()=>({}));if(!t.ok)throw Error(r.error||"Update failed");h("Category updated successfully")}else{let e=f(!0),t=await p.from("categories").insert([e]);if(t.error?.message?.includes("show_in_header")&&t.error?.message?.includes("schema cache")&&(t=await p.from("categories").insert([f(!1)])),t.error)throw t.error;h("Category created successfully")}b(),await y()}catch(e){h(`Error: ${(0,s.getErrorMessage)(e)}`)}finally{d(!1)}}async function N(e){try{let t=await fetch(`/api/admin/categories/${e}`,{method:"DELETE"}),r=await t.json().catch(()=>({}));if(!t.ok)throw Error(r.error||"Delete failed");h("Category deleted successfully"),await y()}catch(e){h(`Error: ${(0,s.getErrorMessage)(e)}`)}}async function w(e,t){try{let r=await fetch(`/api/admin/categories/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:t})}),a=await r.json().catch(()=>({}));if(!r.ok)throw Error(a.error||"Update failed");await y()}catch(e){h(`Error: ${(0,s.getErrorMessage)(e)}`)}}return(0,r.useEffect)(()=>{y()},[y]),(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-semibold text-gray-900 mb-2",children:"Ангилал удирдах"}),(0,t.jsx)("p",{className:"text-base text-gray-600",children:"Бүтээгдэхүүний ангилал нэмэх, засах"})]}),u&&(0,t.jsx)("div",{className:`mb-6 p-4 rounded-lg ${u.includes("Error")?"bg-red-50 text-red-800":"bg-green-50 text-green-800"}`,children:u}),(0,t.jsx)(n,{editing:o,formData:g,onFormChange:function(e,t){x(r=>({...r,[e]:t}))},onSubmit:j,onCancel:b,loading:c}),(0,t.jsx)(l,{categories:e,loading:c,onEdit:function(e){x({name:e.name,name_en:e.name_en||"",name_mn:e.name_mn||"",slug:e.slug,is_active:e.is_active??!0,display_order:e.display_order||0,show_in_header:e.show_in_header||!1}),m(e.id),h("")},onDelete:N,onToggleActive:w})]})}e.s(["default",()=>c],69888)}]);